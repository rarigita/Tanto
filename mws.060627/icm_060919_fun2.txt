> restart;Digits:=30;
                          Digits := 30
> fun:=proc(k,a,b)
>   local L,i;
>   for i from a by 1 to (k-1) do;
>     if( (i mod a)= 0 or (i mod b)=0 ) then
>       print( i, convert(i,binary), gcd(k*i,k-i) );
>     end if;
>   end do;
> end proc:
> fun2:=proc(k,a,b)
>   local i,j,r1,r2;
>   j:=1;
>   r2:=b*j;
>   for i from 1 by 1 to b do;
>     r1:=a*i;
>     if( r1 < r2 ) then
>       if( r2 = r1+1 ) then
>         print("---");
>       end if;
>       print( r1, convert(r1,binary), gcd(k,r1) );
>     else
>       print( r2, convert(r2,binary), gcd(k,r2) );
>       print( r1, convert(r1,binary), gcd(k,r1) );
>       if( r1 = r2+1 ) then
>         print("---");
>       end if;
>       j:=j+1;
>       r2:=b*j;
>     end if;
>   end do;
> end proc:
> fun3:=proc(k,p1)
>   local a,b,c,d;
>   a := k/2;
>   b := a/p1;
>   c := p1*floor(b);
>   d := p1*(floor(b)+1);
>   print( c, a-c, d, d-a, (a-c)-(d-a) );
> 
> end proc:
> fun4:=proc(k,p1)
>   local i;
>   for i from 1 by 1 to p1 do;
>     print( i );
>     fun3(k,i);
>     print("---");
>   end do;
> end proc:
> 
> fun2(33,3,11);
                            3, 11, 3
                           6, 110, 3
                           9, 1001, 3
                          11, 1011, 11
                          12, 1100, 3
                             "---"
                          15, 1111, 3
                          18, 10010, 3
                             "---"
                          21, 10101, 3
                         22, 10110, 11
                          24, 11000, 3
                          27, 11011, 3
                          30, 11110, 3
                         33, 100001, 33
                         33, 100001, 33
                               44
> p1:=7;p2:=23;k:=p1*p2;
                            p1 := 7
                            p2 := 23
                            k := 161
> fun2(k,p1,p2);
                           7, 111, 7
                          14, 1110, 7
                          21, 10101, 7
                         23, 10111, 23
                          28, 11100, 7
                         35, 100011, 7
                         42, 101010, 7
                         46, 101110, 23
                         49, 110001, 7
                         56, 111000, 7
                         63, 111111, 7
                        69, 1000101, 23
                         70, 1000110, 7
                             "---"
                         77, 1001101, 7
                         84, 1010100, 7
                             "---"
                         91, 1011011, 7
                        92, 1011100, 23
                         98, 1100010, 7
                        105, 1101001, 7
                        112, 1110000, 7
                        115, 1110011, 23
                        119, 1110111, 7
                        126, 1111110, 7
                        133, 10000101, 7
                       138, 10001010, 23
                        140, 10001100, 7
                        147, 10010011, 7
                        154, 10011010, 7
                       161, 10100001, 161
                       161, 10100001, 161
                              184
> p1:=23;p2:=61;k:=p1*p2;
                            p1 := 23
                            p2 := 61
                           k := 1403
> fun2(k,p1,p2);
                         23, 10111, 23
                         46, 101110, 23
                         61, 111101, 61
                        69, 1000101, 23
                        92, 1011100, 23
                        115, 1110011, 23
                        122, 1111010, 61
                       138, 10001010, 23
                       161, 10100001, 23
                       183, 10110111, 61
                       184, 10111000, 23
                             "---"
                       207, 11001111, 23
                       230, 11100110, 23
                       244, 11110100, 61
                       253, 11111101, 23
                       276, 100010100, 23
                       299, 100101011, 23
                       305, 100110001, 61
                       322, 101000010, 23
                       345, 101011001, 23
                       366, 101101110, 61
                       368, 101110000, 23
                       391, 110000111, 23
                       414, 110011110, 23
                       427, 110101011, 61
                       437, 110110101, 23
                       460, 111001100, 23
                       483, 111100011, 23
                       488, 111101000, 61
                       506, 111111010, 23
                      529, 1000010001, 23
                      549, 1000100101, 61
                      552, 1000101000, 23
                      575, 1000111111, 23
                      598, 1001010110, 23
                      610, 1001100010, 61
                      621, 1001101101, 23
                      644, 1010000100, 23
                      667, 1010011011, 23
                      671, 1010011111, 61
                      690, 1010110010, 23
                      713, 1011001001, 23
                      732, 1011011100, 61
                      736, 1011100000, 23
                      759, 1011110111, 23
                      782, 1100001110, 23
                      793, 1100011001, 61
                      805, 1100100101, 23
                      828, 1100111100, 23
                      851, 1101010011, 23
                      854, 1101010110, 61
                      874, 1101101010, 23
                      897, 1110000001, 23
                      915, 1110010011, 61
                      920, 1110011000, 23
                      943, 1110101111, 23
                      966, 1111000110, 23
                      976, 1111010000, 61
                      989, 1111011101, 23
                      1012, 1111110100, 23
                     1035, 10000001011, 23
                     1037, 10000001101, 61
                     1058, 10000100010, 23
                     1081, 10000111001, 23
                     1098, 10001001010, 61
                     1104, 10001010000, 23
                     1127, 10001100111, 23
                     1150, 10001111110, 23
                     1159, 10010000111, 61
                     1173, 10010010101, 23
                     1196, 10010101100, 23
                             "---"
                     1219, 10011000011, 23
                     1220, 10011000100, 61
                     1242, 10011011010, 23
                     1265, 10011110001, 23
                     1281, 10100000001, 61
                     1288, 10100001000, 23
                     1311, 10100011111, 23
                     1334, 10100110110, 23
                     1342, 10100111110, 61
                     1357, 10101001101, 23
                     1380, 10101100100, 23
                    1403, 10101111011, 1403
                    1403, 10101111011, 1403
                              1464
> p1:=101;p2:=103;k:=p1*p2;
                           p1 := 101
                           p2 := 103
                           k := 10403
> fun2(k,p1,p2);
                       101, 1100101, 101
                       103, 1100111, 103
                       202, 11001010, 101
                       206, 11001110, 103
                      303, 100101111, 101
                      309, 100110101, 103
                      404, 110010100, 101
                      412, 110011100, 103
                      505, 111111001, 101
                      515, 1000000011, 103
                      606, 1001011110, 101
                      618, 1001101010, 103
                      707, 1011000011, 101
                      721, 1011010001, 103
                      808, 1100101000, 101
                      824, 1100111000, 103
                      909, 1110001101, 101
                      927, 1110011111, 103
                     1010, 1111110010, 101
                     1030, 10000000110, 103
                     1111, 10001010111, 101
                     1133, 10001101101, 103
                     1212, 10010111100, 101
                     1236, 10011010100, 103
                     1313, 10100100001, 101
                     1339, 10100111011, 103
                     1414, 10110000110, 101
                     1442, 10110100010, 103
                     1515, 10111101011, 101
                     1545, 11000001001, 103
                     1616, 11001010000, 101
                     1648, 11001110000, 103
                     1717, 11010110101, 101
                     1751, 11011010111, 103
                     1818, 11100011010, 101
                     1854, 11100111110, 103
                     1919, 11101111111, 101
                     1957, 11110100101, 103
                     2020, 11111100100, 101
                    2060, 100000001100, 103
                    2121, 100001001001, 101
                    2163, 100001110011, 103
                    2222, 100010101110, 101
                    2266, 100011011010, 103
                    2323, 100100010011, 101
                    2369, 100101000001, 103
                    2424, 100101111000, 101
                    2472, 100110101000, 103
                    2525, 100111011101, 101
                    2575, 101000001111, 103
                    2626, 101001000010, 101
                    2678, 101001110110, 103
                    2727, 101010100111, 101
                    2781, 101011011101, 103
                    2828, 101100001100, 101
                    2884, 101101000100, 103
                    2929, 101101110001, 101
                    2987, 101110101011, 103
                    3030, 101111010110, 101
                    3090, 110000010010, 103
                    3131, 110000111011, 101
                    3193, 110001111001, 103
                    3232, 110010100000, 101
                    3296, 110011100000, 103
                    3333, 110100000101, 101
                    3399, 110101000111, 103
                    3434, 110101101010, 101
                    3502, 110110101110, 103
                    3535, 110111001111, 101
                    3605, 111000010101, 103
                    3636, 111000110100, 101
                    3708, 111001111100, 103
                    3737, 111010011001, 101
                    3811, 111011100011, 103
                    3838, 111011111110, 101
                    3914, 111101001010, 103
                    3939, 111101100011, 101
                    4017, 111110110001, 103
                    4040, 111111001000, 101
                    4120, 1000000011000, 103
                    4141, 1000000101101, 101
                    4223, 1000001111111, 103
                    4242, 1000010010010, 101
                    4326, 1000011100110, 103
                    4343, 1000011110111, 101
                    4429, 1000101001101, 103
                    4444, 1000101011100, 101
                    4532, 1000110110100, 103
                    4545, 1000111000001, 101
                    4635, 1001000011011, 103
                    4646, 1001000100110, 101
                    4738, 1001010000010, 103
                    4747, 1001010001011, 101
                    4841, 1001011101001, 103
                    4848, 1001011110000, 101
                    4944, 1001101010000, 103
                    4949, 1001101010101, 101
                    5047, 1001110110111, 103
                    5050, 1001110111010, 101
                    5150, 1010000011110, 103
                    5151, 1010000011111, 101
                             "---"
                             "---"
                    5252, 1010010000100, 101
                    5253, 1010010000101, 103
                    5353, 1010011101001, 101
                    5356, 1010011101100, 103
                    5454, 1010101001110, 101
                    5459, 1010101010011, 103
                    5555, 1010110110011, 101
                    5562, 1010110111010, 103
                    5656, 1011000011000, 101
                    5665, 1011000100001, 103
                    5757, 1011001111101, 101
                    5768, 1011010001000, 103
                    5858, 1011011100010, 101
                    5871, 1011011101111, 103
                    5959, 1011101000111, 101
                    5974, 1011101010110, 103
                    6060, 1011110101100, 101
                    6077, 1011110111101, 103
                    6161, 1100000010001, 101
                    6180, 1100000100100, 103
                    6262, 1100001110110, 101
                    6283, 1100010001011, 103
                    6363, 1100011011011, 101
                    6386, 1100011110010, 103
                    6464, 1100101000000, 101
                    6489, 1100101011001, 103
                    6565, 1100110100101, 101
                    6592, 1100111000000, 103
                    6666, 1101000001010, 101
                    6695, 1101000100111, 103
                    6767, 1101001101111, 101
                    6798, 1101010001110, 103
                    6868, 1101011010100, 101
                    6901, 1101011110101, 103
                    6969, 1101100111001, 101
                    7004, 1101101011100, 103
                    7070, 1101110011110, 101
                    7107, 1101111000011, 103
                    7171, 1110000000011, 101
                    7210, 1110000101010, 103
                    7272, 1110001101000, 101
                    7313, 1110010010001, 103
                    7373, 1110011001101, 101
                    7416, 1110011111000, 103
                    7474, 1110100110010, 101
                    7519, 1110101011111, 103
                    7575, 1110110010111, 101
                    7622, 1110111000110, 103
                    7676, 1110111111100, 101
                    7725, 1111000101101, 103
                    7777, 1111001100001, 101
                    7828, 1111010010100, 103
                    7878, 1111011000110, 101
                    7931, 1111011111011, 103
                    7979, 1111100101011, 101
                    8034, 1111101100010, 103
                    8080, 1111110010000, 101
                    8137, 1111111001001, 103
                    8181, 1111111110101, 101
                   8240, 10000000110000, 103
                   8282, 10000001011010, 101
                   8343, 10000010010111, 103
                   8383, 10000010111111, 101
                   8446, 10000011111110, 103
                   8484, 10000100100100, 101
                   8549, 10000101100101, 103
                   8585, 10000110001001, 101
                   8652, 10000111001100, 103
                   8686, 10000111101110, 101
                   8755, 10001000110011, 103
                   8787, 10001001010011, 101
                   8858, 10001010011010, 103
                   8888, 10001010111000, 101
                   8961, 10001100000001, 103
                   8989, 10001100011101, 101
                   9064, 10001101101000, 103
                   9090, 10001110000010, 101
                   9167, 10001111001111, 103
                   9191, 10001111100111, 101
                   9270, 10010000110110, 103
                   9292, 10010001001100, 101
                   9373, 10010010011101, 103
                   9393, 10010010110001, 101
                   9476, 10010100000100, 103
                   9494, 10010100010110, 101
                   9579, 10010101101011, 103
                   9595, 10010101111011, 101
                   9682, 10010111010010, 103
                   9696, 10010111100000, 101
                   9785, 10011000111001, 103
                   9797, 10011001000101, 101
                   9888, 10011010100000, 103
                   9898, 10011010101010, 101
                   9991, 10011100000111, 103
                   9999, 10011100001111, 101
                   10094, 10011101101110, 103
                   10100, 10011101110100, 101
                   10197, 10011111010101, 103
                   10201, 10011111011001, 101
                   10300, 10100000111100, 103
                   10302, 10100000111110, 101
                  10403, 10100010100011, 10403
                  10403, 10100010100011, 10403
                             10506
> p1:=59;p2:=127;k:=p1*p2;
                            p1 := 59
                           p2 := 127
                           k := 7493
> fun2(k,p1,p2);
                         59, 111011, 59
                        118, 1110110, 59
                       127, 1111111, 127
                       177, 10110001, 59
                       236, 11101100, 59
                       254, 11111110, 127
                       295, 100100111, 59
                       354, 101100010, 59
                      381, 101111101, 127
                       413, 110011101, 59
                       472, 111011000, 59
                      508, 111111100, 127
                      531, 1000010011, 59
                      590, 1001001110, 59
                      635, 1001111011, 127
                      649, 1010001001, 59
                      708, 1011000100, 59
                      762, 1011111010, 127
                      767, 1011111111, 59
                      826, 1100111010, 59
                      885, 1101110101, 59
                      889, 1101111001, 127
                      944, 1110110000, 59
                      1003, 1111101011, 59
                     1016, 1111111000, 127
                     1062, 10000100110, 59
                     1121, 10001100001, 59
                     1143, 10001110111, 127
                     1180, 10010011100, 59
                     1239, 10011010111, 59
                     1270, 10011110110, 127
                     1298, 10100010010, 59
                     1357, 10101001101, 59
                     1397, 10101110101, 127
                     1416, 10110001000, 59
                     1475, 10111000011, 59
                     1524, 10111110100, 127
                     1534, 10111111110, 59
                     1593, 11000111001, 59
                     1651, 11001110011, 127
                     1652, 11001110100, 59
                             "---"
                     1711, 11010101111, 59
                     1770, 11011101010, 59
                     1778, 11011110010, 127
                     1829, 11100100101, 59
                     1888, 11101100000, 59
                     1905, 11101110001, 127
                     1947, 11110011011, 59
                     2006, 11111010110, 59
                     2032, 11111110000, 127
                     2065, 100000010001, 59
                     2124, 100001001100, 59
                    2159, 100001101111, 127
                     2183, 100010000111, 59
                     2242, 100011000010, 59
                    2286, 100011101110, 127
                     2301, 100011111101, 59
                     2360, 100100111000, 59
                    2413, 100101101101, 127
                     2419, 100101110011, 59
                     2478, 100110101110, 59
                     2537, 100111101001, 59
                    2540, 100111101100, 127
                     2596, 101000100100, 59
                     2655, 101001011111, 59
                    2667, 101001101011, 127
                     2714, 101010011010, 59
                     2773, 101011010101, 59
                    2794, 101011101010, 127
                     2832, 101100010000, 59
                     2891, 101101001011, 59
                    2921, 101101101001, 127
                     2950, 101110000110, 59
                     3009, 101111000001, 59
                    3048, 101111101000, 127
                     3068, 101111111100, 59
                     3127, 110000110111, 59
                    3175, 110001100111, 127
                     3186, 110001110010, 59
                     3245, 110010101101, 59
                    3302, 110011100110, 127
                     3304, 110011101000, 59
                     3363, 110100100011, 59
                     3422, 110101011110, 59
                    3429, 110101100101, 127
                     3481, 110110011001, 59
                     3540, 110111010100, 59
                    3556, 110111100100, 127
                     3599, 111000001111, 59
                     3658, 111001001010, 59
                    3683, 111001100011, 127
                     3717, 111010000101, 59
                     3776, 111011000000, 59
                    3810, 111011100010, 127
                     3835, 111011111011, 59
                     3894, 111100110110, 59
                    3937, 111101100001, 127
                     3953, 111101110001, 59
                     4012, 111110101100, 59
                    4064, 111111100000, 127
                     4071, 111111100111, 59
                    4130, 1000000100010, 59
                    4189, 1000001011101, 59
                    4191, 1000001011111, 127
                    4248, 1000010011000, 59
                    4307, 1000011010011, 59
                    4318, 1000011011110, 127
                    4366, 1000100001110, 59
                    4425, 1000101001001, 59
                    4445, 1000101011101, 127
                    4484, 1000110000100, 59
                    4543, 1000110111111, 59
                    4572, 1000111011100, 127
                    4602, 1000111111010, 59
                    4661, 1001000110101, 59
                    4699, 1001001011011, 127
                    4720, 1001001110000, 59
                    4779, 1001010101011, 59
                    4826, 1001011011010, 127
                    4838, 1001011100110, 59
                    4897, 1001100100001, 59
                    4953, 1001101011001, 127
                    4956, 1001101011100, 59
                    5015, 1001110010111, 59
                    5074, 1001111010010, 59
                    5080, 1001111011000, 127
                    5133, 1010000001101, 59
                    5192, 1010001001000, 59
                    5207, 1010001010111, 127
                    5251, 1010010000011, 59
                    5310, 1010010111110, 59
                    5334, 1010011010110, 127
                    5369, 1010011111001, 59
                    5428, 1010100110100, 59
                    5461, 1010101010101, 127
                    5487, 1010101101111, 59
                    5546, 1010110101010, 59
                    5588, 1010111010100, 127
                    5605, 1010111100101, 59
                    5664, 1011000100000, 59
                    5715, 1011001010011, 127
                    5723, 1011001011011, 59
                    5782, 1011010010110, 59
                             "---"
                    5841, 1011011010001, 59
                    5842, 1011011010010, 127
                    5900, 1011100001100, 59
                    5959, 1011101000111, 59
                    5969, 1011101010001, 127
                    6018, 1011110000010, 59
                    6077, 1011110111101, 59
                    6096, 1011111010000, 127
                    6136, 1011111111000, 59
                    6195, 1100000110011, 59
                    6223, 1100001001111, 127
                    6254, 1100001101110, 59
                    6313, 1100010101001, 59
                    6350, 1100011001110, 127
                    6372, 1100011100100, 59
                    6431, 1100100011111, 59
                    6477, 1100101001101, 127
                    6490, 1100101011010, 59
                    6549, 1100110010101, 59
                    6604, 1100111001100, 127
                    6608, 1100111010000, 59
                    6667, 1101000001011, 59
                    6726, 1101001000110, 59
                    6731, 1101001001011, 127
                    6785, 1101010000001, 59
                    6844, 1101010111100, 59
                    6858, 1101011001010, 127
                    6903, 1101011110111, 59
                    6962, 1101100110010, 59
                    6985, 1101101001001, 127
                    7021, 1101101101101, 59
                    7080, 1101110101000, 59
                    7112, 1101111001000, 127
                    7139, 1101111100011, 59
                    7198, 1110000011110, 59
                    7239, 1110001000111, 127
                    7257, 1110001011001, 59
                    7316, 1110010010100, 59
                    7366, 1110011000110, 127
                    7375, 1110011001111, 59
                    7434, 1110100001010, 59
                   7493, 1110101000101, 7493
                   7493, 1110101000101, 7493
                              7620
> #p1:=1237;p2:=9743;k:=p1*p2;
> #fun2(k,p1,p2);
> p1:=nextprime(34);p2:=nextprime(76);k:=p1*p2;
                            p1 := 37
                            p2 := 79
                           k := 2923
> fun2(k,p1,p2);
                         37, 100101, 37
                        74, 1001010, 37
                        79, 1001111, 79
                        111, 1101111, 37
                       148, 10010100, 37
                       158, 10011110, 79
                       185, 10111001, 37
                       222, 11011110, 37
                       237, 11101101, 79
                       259, 100000011, 37
                       296, 100101000, 37
                       316, 100111100, 79
                       333, 101001101, 37
                       370, 101110010, 37
                       395, 110001011, 79
                       407, 110010111, 37
                       444, 110111100, 37
                       474, 111011010, 79
                       481, 111100001, 37
                      518, 1000000110, 37
                      553, 1000101001, 79
                      555, 1000101011, 37
                      592, 1001010000, 37
                      629, 1001110101, 37
                      632, 1001111000, 79
                      666, 1010011010, 37
                      703, 1010111111, 37
                      711, 1011000111, 79
                      740, 1011100100, 37
                      777, 1100001001, 37
                      790, 1100010110, 79
                      814, 1100101110, 37
                      851, 1101010011, 37
                      869, 1101100101, 79
                      888, 1101111000, 37
                      925, 1110011101, 37
                      948, 1110110100, 79
                      962, 1111000010, 37
                      999, 1111100111, 37
                     1027, 10000000011, 79
                     1036, 10000001100, 37
                     1073, 10000110001, 37
                     1106, 10001010010, 79
                     1110, 10001010110, 37
                     1147, 10001111011, 37
                             "---"
                     1184, 10010100000, 37
                     1185, 10010100001, 79
                     1221, 10011000101, 37
                     1258, 10011101010, 37
                     1264, 10011110000, 79
                     1295, 10100001111, 37
                     1332, 10100110100, 37
                     1343, 10100111111, 79
                     1369, 10101011001, 37
                     1406, 10101111110, 37
                     1422, 10110001110, 79
                     1443, 10110100011, 37
                     1480, 10111001000, 37
                     1501, 10111011101, 79
                     1517, 10111101101, 37
                     1554, 11000010010, 37
                     1580, 11000101100, 79
                     1591, 11000110111, 37
                     1628, 11001011100, 37
                     1659, 11001111011, 79
                     1665, 11010000001, 37
                     1702, 11010100110, 37
                     1738, 11011001010, 79
                     1739, 11011001011, 37
                             "---"
                     1776, 11011110000, 37
                     1813, 11100010101, 37
                     1817, 11100011001, 79
                     1850, 11100111010, 37
                     1887, 11101011111, 37
                     1896, 11101101000, 79
                     1924, 11110000100, 37
                     1961, 11110101001, 37
                     1975, 11110110111, 79
                     1998, 11111001110, 37
                     2035, 11111110011, 37
                     2054, 100000000110, 79
                     2072, 100000011000, 37
                     2109, 100000111101, 37
                     2133, 100001010101, 79
                     2146, 100001100010, 37
                     2183, 100010000111, 37
                     2212, 100010100100, 79
                     2220, 100010101100, 37
                     2257, 100011010001, 37
                     2291, 100011110011, 79
                     2294, 100011110110, 37
                     2331, 100100011011, 37
                     2368, 100101000000, 37
                     2370, 100101000010, 79
                     2405, 100101100101, 37
                     2442, 100110001010, 37
                     2449, 100110010001, 79
                     2479, 100110101111, 37
                     2516, 100111010100, 37
                     2528, 100111100000, 79
                     2553, 100111111001, 37
                     2590, 101000011110, 37
                     2607, 101000101111, 79
                     2627, 101001000011, 37
                     2664, 101001101000, 37
                     2686, 101001111110, 79
                     2701, 101010001101, 37
                     2738, 101010110010, 37
                     2765, 101011001101, 79
                     2775, 101011010111, 37
                     2812, 101011111100, 37
                     2844, 101100011100, 79
                     2849, 101100100001, 37
                     2886, 101101000110, 37
                    2923, 101101101011, 2923
                    2923, 101101101011, 2923
                              3002
> 



